import{r as a,a as g,a4 as j,j as e,E as w,C as k,c as v,d as N,e as P,f as S,B as E,s as l,q as u}from"./index-Caw7KGCA.js";import{P as b,U as y}from"./PasswordUpdateSuccess-B5OtE0Jr.js";import"./passwordValidator-GZWggTWZ.js";import"./form-CcKQMLHU.js";import"./alert-D_V2V2Ts.js";import"./circle-check-big-BCGySWHe.js";const B=()=>{const[i,x]=a.useState(!1),[h,p]=a.useState(!0),[t,o]=a.useState(null),c=g(),[n]=j();a.useEffect(()=>{(async()=>{try{const s=n.get("access_token"),d=n.get("refresh_token");if(s&&d){const{error:r}=await l.auth.setSession({access_token:s,refresh_token:d});r&&(console.error("Error setting session:",r),o("Invalid or expired reset link. Please request a new password reset."),u({title:"Invalid reset link",description:"This password reset link is invalid or expired. Please request a new one.",variant:"destructive"}))}else{const{data:{session:r}}=await l.auth.getSession();r||(o("No valid session found. Please request a new password reset."),u({title:"Session expired",description:"Your session has expired. Please request a new password reset.",variant:"destructive"}))}}catch(s){console.error("Error checking session:",s),o("An error occurred. Please try again.")}finally{p(!1)}})()},[n]);const m=()=>{c("/login",{replace:!0})},f=()=>{x(!0),setTimeout(()=>{c("/login",{replace:!0})},3e3)};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[#FFEFE9] to-[#fffdf9]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-chichi-orange mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e.jsx(w,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[#FFEFE9] to-[#fffdf9]",children:e.jsxs(k,{className:"w-full max-w-md shadow-lg",children:[e.jsxs(v,{className:"space-y-1 text-center px-4 sm:px-6",children:[e.jsx(N,{className:"text-2xl sm:text-3xl font-bold",children:e.jsx("span",{className:"text-chichi-orange",children:"CHICHI"})}),e.jsx(P,{children:t?"Reset Link Error":i?"Password Updated":"Update your password"})]}),e.jsx(S,{className:"px-4 sm:px-6",children:t?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-red-600",children:t}),e.jsx(E,{onClick:m,className:"w-full bg-chichi-orange hover:bg-chichi-orange/90",children:"Back to Login"})]}):i?e.jsx(b,{}):e.jsx(y,{onSuccess:f})})]})})})};export{B as default};
