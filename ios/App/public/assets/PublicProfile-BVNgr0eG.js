import{p as _,a as I,j as e,B as i,C as g,f as N,ah as q,ai as S,aj as E,an as f,ao as P,c as M,d as U,u as A,ag as D,r as o,D as $,h as L,i as R,k as W,T as z,s as p,ap as O,aq as G}from"./index-Caw7KGCA.js";import{U as V,a as k}from"./UserProfileActions-ChRHtiKK.js";import{U as Y}from"./users-Bala6d7Y.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=_("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=_("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function K({profile:t,isOwnProfile:s,isFollowing:n,isProcessing:r,user:x,onFollow:d,onMessage:c}){const m=I(),h=t.name||t.username||"Unknown Creator";return e.jsxs(e.Fragment,{children:[e.jsxs(i,{variant:"ghost",onClick:()=>m(-1),className:"mb-4",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(g,{className:"bg-gradient-to-r from-chichi-purple/10 to-chichi-orange/10 border-2 border-chichi-purple/20",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start space-y-4 md:space-y-0 md:space-x-6",children:[e.jsxs(q,{className:"h-24 w-24 border-4 border-chichi-purple/20",children:[e.jsx(S,{src:t.avatar_url||void 0}),e.jsx(E,{className:"bg-chichi-purple text-white text-2xl",children:h.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:h}),t.username&&e.jsxs("p",{className:"text-xl text-gray-600 mb-3",children:["@",t.username]}),e.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-2 mb-4",children:[e.jsxs(f,{variant:"secondary",className:"bg-chichi-purple text-white",children:["Level ",t.level||1]}),t.points&&t.points>=1e3&&e.jsxs(f,{variant:"secondary",className:"bg-chichi-orange text-white",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Top Performer"]})]}),t.niche_preferences&&t.niche_preferences.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Content Niche"}),e.jsx("div",{className:"flex flex-wrap justify-center md:justify-start gap-2",children:t.niche_preferences.slice(0,2).map(u=>e.jsx(f,{variant:"outline",className:"border-chichi-purple text-chichi-purple",children:u},u))})]})]})]}),!s&&x&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx(V,{isFollowing:n,isProcessing:r,onFollow:d,onMessage:c})}),s&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx(i,{onClick:()=>m("/profile"),className:"w-full md:w-auto bg-chichi-purple hover:bg-chichi-purple/90",children:"Edit Profile"})})]})})]})}function Q({connectedCreators:t}){return e.jsxs(g,{children:[e.jsx(M,{children:e.jsxs(U,{className:"flex items-center gap-2 text-chichi-purple",children:[e.jsx(Y,{className:"h-5 w-5"}),"Connected Creators (",t.length,")"]})}),e.jsx(N,{children:t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No connections yet"}):e.jsx("div",{className:"grid grid-cols-3 gap-3",children:t.map(s=>e.jsxs("div",{className:"text-center",children:[e.jsxs(q,{className:"h-12 w-12 mx-auto mb-2 border-2 border-chichi-purple/20",children:[e.jsx(S,{src:s.avatar_url||void 0}),e.jsx(E,{className:"bg-chichi-purple/10 text-chichi-purple",children:(s.name||s.username||"U").charAt(0).toUpperCase()})]}),e.jsx("p",{className:"text-xs font-medium truncate",children:s.name||s.username||"Unknown"}),s.username&&e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["@",s.username]})]},s.id))})})]})}function X({recentWins:t}){return e.jsxs(g,{children:[e.jsx(M,{children:e.jsxs(U,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-chichi-purple",children:[e.jsx(P,{className:"h-5 w-5"}),"Recent Wins"]}),t.length>0&&e.jsx(i,{variant:"outline",size:"sm",children:"View Full Win Wall"})]})}),e.jsx(N,{children:t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No wins shared yet"}):e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"border rounded-lg p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.title}),e.jsx(f,{variant:"outline",className:"text-xs",children:s.platform})]}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.slice(0,2).map((n,r)=>e.jsx(f,{variant:"secondary",className:"text-xs",children:n},r))})]},s.id))})})]})}function Z({isOpen:t,onClose:s,recipientId:n,recipientName:r}){const{user:x}=A(),{toast:d}=D(),[c,m]=o.useState(""),[h,u]=o.useState(!1),j=async()=>{if(!(!x||!c.trim())){u(!0);try{const{error:l}=await p.from("user_messages").insert({sender_id:x.id,recipient_id:n,message:c.trim()});if(l){console.error("Error sending message:",l),d({title:"Error",description:"Failed to send message",variant:"destructive"});return}d({title:"Message sent!",description:`Your message has been sent to ${r}`}),m(""),s()}catch(l){console.error("Error:",l),d({title:"Error",description:"Failed to send message",variant:"destructive"})}finally{u(!1)}}};return e.jsx($,{open:t,onOpenChange:s,children:e.jsxs(L,{className:"sm:max-w-[425px]",children:[e.jsx(R,{children:e.jsxs(W,{children:["Send Message to ",r]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{placeholder:"Type your message here...",value:c,onChange:l=>m(l.target.value),rows:4}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(i,{onClick:j,disabled:!c.trim()||h,children:h?"Sending...":"Send Message"})]})]})]})})}const te=()=>{const{username:t}=O(),{user:s}=A(),{toast:n}=D(),[r,x]=o.useState(null),[d,c]=o.useState(!0),[m,h]=o.useState(!1),[u,j]=o.useState("none"),[l,v]=o.useState(!1);o.useEffect(()=>{t&&(T(),s&&B())},[t,s]);const T=async()=>{try{c(!0);const{data:a,error:y}=await p.from("user_profiles").select("*").eq("username",t).single();if(y){console.error("Error fetching profile:",y),n({title:"Error",description:"Could not load user profile",variant:"destructive"});return}a&&x({...a,niche_preferences:a.niche_preferences||[]})}catch(a){console.error("Error:",a),n({title:"Error",description:"Could not load user profile",variant:"destructive"})}finally{c(!1)}},B=async()=>{if(!(!s||!r))try{const{data:a,error:y}=await p.from("connection_requests").select("status").or(`and(requester_id.eq.${s.id},requested_id.eq.${r.id}),and(requester_id.eq.${r.id},requested_id.eq.${s.id})`).single();if(a){const C=a.status;j(C),h(C==="accepted")}}catch(a){console.error("Error checking connection status:",a)}},w=async()=>{if(!(!s||!r))try{const{error:a}=await p.from("connection_requests").insert({requester_id:s.id,requested_id:r.id,status:"pending"});if(a){console.error("Error sending connection request:",a),n({title:"Error",description:"Could not send connection request",variant:"destructive"});return}await p.from("notifications").insert({user_id:r.id,type:"connection_request",title:"New Connection Request",message:`${s.name||"Someone"} wants to connect with you on CHICHI.`}),j("pending"),n({title:"Connection request sent!",description:`We've sent a connection request to ${r.name}`})}catch(a){console.error("Error:",a),n({title:"Error",description:"Could not send connection request",variant:"destructive"})}},F=()=>{if(!s||s.id===(r==null?void 0:r.id))return null;switch(u){case"accepted":return e.jsxs(i,{className:"flex-1",variant:"outline",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Connected"]});case"pending":return e.jsxs(i,{className:"flex-1",variant:"outline",disabled:!0,children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Request Sent"]});default:return e.jsxs(i,{onClick:w,className:"flex-1",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Connect"]})}};if(d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-chichi-purple"})});if(!r)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(g,{className:"max-w-md w-full",children:e.jsxs(N,{className:"p-6 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"User not found"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["The user @",t," doesn't exist or has been deactivated."]}),e.jsxs(i,{onClick:()=>window.history.back(),children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Go Back"]})]})})});const H={id:r.id,name:r.name,username:r.username,avatar_url:r.avatar_url||null,points:r.points,level:r.level,niche_preferences:r.niche_preferences||null};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[e.jsxs(i,{variant:"ghost",onClick:()=>window.history.back(),className:"mb-6",children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsx(K,{profile:H,isOwnProfile:(s==null?void 0:s.id)===r.id,isFollowing:m,isProcessing:!1,user:s,onFollow:w,onMessage:()=>v(!0)}),s&&s.id!==r.id&&e.jsxs("div",{className:"flex gap-3 mb-8",children:[F(),e.jsxs(i,{variant:"outline",className:"flex-1",onClick:()=>v(!0),children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Message"]})]}),e.jsxs("div",{className:"grid gap-8",children:[e.jsx(X,{recentWins:[]}),e.jsx(Q,{connectedCreators:[]})]}),e.jsx(Z,{isOpen:l,onClose:()=>v(!1),recipientId:r.id,recipientName:r.name})]})})};export{te as default};
