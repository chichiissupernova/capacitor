import{r as u,j as s,I as p,B as P,q as i,s as b}from"./index-Caw7KGCA.js";import{z as c,t as y,C as v,v as N}from"./passwordValidator-GZWggTWZ.js";import{u as F,F as C,a as w,b as h,c as f,d as x,e as j}from"./form-CcKQMLHU.js";import{A as S,a as U}from"./alert-D_V2V2Ts.js";import{C as A}from"./circle-check-big-BCGySWHe.js";const E=c.object({password:c.string().min(6,{message:"Password must be at least 6 characters"}),confirmPassword:c.string().min(6,{message:"Please confirm your password"})}).refine(a=>a.password===a.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),Y=({onSuccess:a})=>{const[l,t]=u.useState(!1),[m,n]=u.useState(null),o=F({resolver:y(E),defaultValues:{password:"",confirmPassword:""}}),g=async e=>{n(null),t(!0);const d=N(e.password);if(!d.isValid){n(d.errors.join(". ")),t(!1),i({title:"Password update failed",description:d.errors.join(". "),variant:"destructive"});return}try{const{error:r}=await b.auth.updateUser({password:e.password});if(r)throw r;i({title:"Password updated",description:"Your password has been successfully updated."}),a()}catch(r){console.error("Password update error:",r),n(r instanceof Error?r.message:"An error occurred. Please try again."),i({title:"Password update failed",description:r instanceof Error?r.message:"An error occurred. Please try again.",variant:"destructive"})}finally{t(!1)}};return s.jsx(C,{...o,children:s.jsxs("form",{onSubmit:o.handleSubmit(g),className:"space-y-4",children:[m&&s.jsxs(S,{variant:"destructive",className:"mb-4",children:[s.jsx(v,{className:"h-4 w-4 mr-2"}),s.jsx(U,{children:m})]}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Please enter your new password below."}),s.jsx(w,{control:o.control,name:"password",render:({field:e})=>s.jsxs(h,{children:[s.jsx(f,{children:"New Password"}),s.jsx(x,{children:s.jsx(p,{type:"password",placeholder:"••••••••",...e})}),s.jsx(j,{})]})}),s.jsx(w,{control:o.control,name:"confirmPassword",render:({field:e})=>s.jsxs(h,{children:[s.jsx(f,{children:"Confirm New Password"}),s.jsx(x,{children:s.jsx(p,{type:"password",placeholder:"••••••••",...e})}),s.jsx(j,{})]})}),s.jsx(P,{type:"submit",className:"w-full bg-chichi-orange hover:bg-chichi-orange/90",disabled:l,children:l?"Updating...":"Update Password"})]})})},k=()=>s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(A,{className:"h-12 w-12 text-green-500"})}),s.jsx("h3",{className:"text-lg font-medium",children:"Password updated successfully"}),s.jsx("p",{className:"text-muted-foreground",children:"You will be redirected to the login page shortly."})]});export{k as P,Y as U};
